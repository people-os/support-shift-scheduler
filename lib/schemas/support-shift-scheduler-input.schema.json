{
  "$schema": "http://json-schema.org/draft-04/schema#",

  "description": "Support shift scheduler input JSON schema",
  "type": "object",
  "properties": {
    "agents": {
      "description": "List of agents to consider while generating the schedule",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "handle": {
            "description": "Agent's handle",
            "type": "string",
            "pattern": "^@[a-zA-Z0-9_\\-+]"
          },
          "email": {
            "description": "Agent's email address",
            "type": "string",
            "pattern": "[a-zA-Z0-9._%+\\-]+@[a-zA-Z0-9.\\-]+\\.[a-zA-Z]{2,4}"
          },
          "weight": {
            "description": "Responsibility weight on Monday of week to be scheduled",
            "type": "number"
          },
          "teamworkBalance": {
            "description": "Current teamwork balance",
            "type": "number"
          },
          "nextWeekCredit": {
            "description": "Existing teamwork credit for the next week in hours",
            "type": "number",
            "minimum": 0
          },
          "idealShiftLength": {
            "description": "Preferred shift length in hours",
            "type": "number",
            "minimum": 2,
            "maximum": 8
          },
          "availableSlots": {
            "description": "Availability for each day of the week, Monday to Friday",
            "type": "array",
            "minItems": 5,
            "maxItems": 5,
            "items": {
              "description": "Availability for single weekday",
              "type": "array",
              "minItems": 48,
              "maxItems": 54,
              "items": {
                "description": "Preference legend - 0: unavailable, 1: preferred, 2: available, not preferred, 3: ask-me-nicely, 4: volunteered",
                "type": "number",
                "minimum": 0,
                "maximum": 4
              }
            }
          }
        },
        "required": [ "handle", "email", "weight", "teamworkBalance", "nextWeekCredit", "idealShiftLength", "availableSlots"]
      }
    },
    "options": {
      "type": "object",
      "properties": {
        "custom_uuid": {
          "description": "Set a custom UUID for the job scheduling request. If this custom_uuid is already set for an existing job, the old job will be removed (and stopped if running) before the new one starts. (Default: empty / random uuid is generated by the server)",
          "type": "string"
        },
        "startMondayDate": {
          "description": "Monday date at start of week being scheduled in YYYY-MM-DD format",
          "type": "string",
          "format": "date"
        },
        "numDays": {
          "description": "Number of consecutive days to schedule",
          "type": "number",
          "minimum": 1,
          "maximum": 5
        },
        "numTracks": {
          "description": "Number of parallel support tracks to schedule",
          "type": "number"
        },
        "startHour": {
          "description": "Balena support start time (default: 6)",
          "type": "number",
          "minimum": 0,
          "maximum": 54
        },
        "endHour": {
          "description": "Balena support end time (default: 27)",
          "type": "number",
          "minimum": 0,
          "maximum": 54
        },
        "shiftMinDuration": {
          "description": "Minimum duration of a shift (default: 2)",
          "type": "number"
        },
        "shiftMaxDuration": {
          "description": "Minimum duration of a shift (default: 8)",
          "type": "number"
        },
        "optimizationTimeout": {
          "description": "Optimization timeout for constraint solver (in seconds)",
          "type": "number"
        },
        "tracks": {
          "description": "Different tracks running in parallel",
          "type": "array",
          "minItems": 1,
          "items": {
            "description": "Object describing length and recurrence of a specific track",
            "type": "object",
            "properties": {
              "start_hour": {
                "description": "Start hour of track",
                "type": "number"
              },
              "end_hour": {
                "description": "End hour of track",
                "type": "number"
              },
              "start_day": {
                "description": "Start day of track (0-indexed)",
                "type": "number"
              },
              "end_day": {
                "description": "End day of track (0-indexed)",
                "type": "number"
              }    
            }
          }

        }
      },
      "required": ["startMondayDate", "numDays", "startHour", "endHour", "shiftMinDuration", "shiftMaxDuration", "optimizationTimeout", "tracks"]
    }
  },
  "required": [ "agents", "options" ]
}


